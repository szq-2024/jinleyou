{"version":3,"file":"my_messages.js","sources":["pages/my/my_messages.vue","../../Programming/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbXkvbXlfbWVzc2FnZXMudnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- 消息列表 -->\n    <scroll-view class=\"message-list\" scroll-y>\n      <view \n        v-for=\"item in chatList\" \n        :key=\"item.userId\"\n        class=\"message-card\"\n        @click=\"enterChat(item)\"\n      >\n        <!-- 用户信息 -->\n        <view class=\"user-info\">\n          <image class=\"avatar\" :src=\"item.avatar || '/static/default-avatar.png'\" />\n          <view class=\"text-info\">\n            <view class=\"top-line\">\n              <text class=\"nickname\">{{ item.nickname }}</text>\n              <text class=\"time\">{{ formatTime(item.lastTime) }}</text>\n            </view>\n            <text class=\"preview\">{{ item.lastContent }}</text>\n          </view>\n        </view>\n        \n        <!-- 未读标识 -->\n        <view v-if=\"item.unread > 0\" class=\"unread-badge\">\n          {{ item.unread > 99 ? '99+' : item.unread }}\n        </view>\n      </view>\n    </scroll-view>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport { onLoad } from '@dcloudio/uni-app';\nimport dayjs from 'dayjs';\nimport { http } from '@/api/http';\n\nconst chatList = ref([]);\n\nonLoad(async () => {\n  // 获取消息列表（假设接口为/chat/contacts）\n  try {\n    const res = await http.get('/api/chat/contacts');\n    chatList.value = res.data.map(item => ({\n      userId: item.userId,\n      nickname: item.nickname,\n      avatar: item.avatar,\n      lastContent: item.lastContent,\n      lastTime: item.lastTime,\n      unread: item.unreadCount\n    }));\n  } catch (e) {\n    uni.showToast({ title: '加载失败', icon: 'none' });\n  }\n});\n\n// 时间格式化\nconst formatTime = (time) => {\n  return dayjs(time).format('MM-DD HH:mm');\n};\n\n// 进入聊天页\nconst enterChat = (item) => {\n  uni.navigateTo({\n    url: `/pages/chat/chat?userId=${item.userId}&title=${encodeURIComponent(item.nickname)}`\n  });\n};\n</script>\n\n<style lang=\"scss\" scoped>\r\n@mixin text-ellipsis {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.container {\n  height: 100vh;\n  background: #f8f8f8;\n  \n  .message-list {\n    height: 100%;\n    padding: 20rpx;\n  }\n\n  .message-card {\n    background: white;\n    border-radius: 16rpx;\n    padding: 24rpx;\n    margin-bottom: 24rpx;\n    position: relative;\n\n    .user-info {\n      display: flex;\n      align-items: center;\n\n      .avatar {\n        width: 80rpx;\n        height: 80rpx;\n        border-radius: 50%;\n        margin-right: 24rpx;\n      }\n\n      .text-info {\n        flex: 1;\n        \n        .top-line {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 12rpx;\n\n          .nickname {\n            font-size: 28rpx;\n            color: #333;\n            max-width: 400rpx;\n            @include text-ellipsis;\n          }\n\n          .time {\n            font-size: 24rpx;\n            color: #999;\n          }\n        }\n\n        .preview {\n          font-size: 26rpx;\n          color: #666;\n          @include text-ellipsis;\n          max-width: 500rpx;\n        }\n      }\n    }\n\n    .unread-badge {\n      position: absolute;\n      right: 24rpx;\n      top: 50%;\n      transform: translateY(-50%);\n      background: #ff3b30;\n      color: white;\n      min-width: 36rpx;\n      height: 36rpx;\n      border-radius: 100rpx;\n      font-size: 24rpx;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: 0 10rpx;\n    }\n  }\n}\n</style>","import MiniProgramPage from 'C:/Users/SZQ/Desktop/jinleyou_GitHub/jinleyou_uniapp/pages/my/my_messages.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","http","uni","dayjs"],"mappings":";;;;;;AAqCA,UAAM,WAAWA,cAAAA,IAAI,CAAA,CAAE;AAEvBC,kBAAAA,OAAO,YAAY;AAEjB,UAAI;AACF,cAAM,MAAM,MAAMC,SAAAA,KAAK,IAAI,oBAAoB;AAC/C,iBAAS,QAAQ,IAAI,KAAK,IAAI,WAAS;AAAA,UACrC,QAAQ,KAAK;AAAA,UACb,UAAU,KAAK;AAAA,UACf,QAAQ,KAAK;AAAA,UACb,aAAa,KAAK;AAAA,UAClB,UAAU,KAAK;AAAA,UACf,QAAQ,KAAK;AAAA,QACd,EAAC;AAAA,MACH,SAAQ,GAAG;AACVC,sBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,OAAM,CAAE;AAAA,MAC9C;AAAA,IACH,CAAC;AAGD,UAAM,aAAa,CAAC,SAAS;AAC3B,aAAOC,cAAK,MAAC,IAAI,EAAE,OAAO,aAAa;AAAA,IACzC;AAGA,UAAM,YAAY,CAAC,SAAS;AAC1BD,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,2BAA2B,KAAK,MAAM,UAAU,mBAAmB,KAAK,QAAQ,CAAC;AAAA,MAC1F,CAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;ACjEA,GAAG,WAAW,eAAe;"}