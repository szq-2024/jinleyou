{"version":3,"file":"setting.js","sources":["pages/my/setting.vue","../../Programming/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbXkvc2V0dGluZy52dWU"],"sourcesContent":["<template>\n  <view class=\"settings-container\">\n    <!-- 简化后的导航栏 -->\n    <view class=\"nav-bar\">\n      <uni-icons type=\"arrowleft\" size=\"24\" color=\"#333\" @click=\"goBack\" />\n      <view class=\"right-placeholder\" />\n    </view>\n\n    <!-- 设置列表 -->\n    <view class=\"settings-list\">\n      <!-- 账号设置 -->\n      <view class=\"section-title\">账号设置</view>\n      <view class=\"setting-item\" @click=\"navigateTo('/pages/my/change_password')\">\n        <view class=\"item-left\">\n          <uni-icons type=\"locked\" size=\"20\" color=\"#666\" />\n          <text>修改密码</text>\n        </view>\n        <uni-icons type=\"arrowright\" size=\"16\" color=\"#ccc\" />\n      </view>\n\n      <!-- 权限管理 -->\n      <!--<view class=\"section-title\">权限管理</view>\n      <view class=\"setting-item\">\n        <view class=\"item-left\">\n          <uni-icons type=\"location\" size=\"20\" color=\"#666\" />\n          <text>定位权限</text>\n        </view>\n        <view class=\"item-right\">\n          <switch \n            :checked=\"locationPermission === 'authorized'\" \n            @change=\"handleSwitchChange\"\n            color=\"#2867CE\"\n            class=\"permission-switch\"\n          />\n        </view>\n      </view>-->\n    </view>\n\n    <!-- 退出登录 -->\n    <view class=\"logout-btn\">\n      <button @click=\"logout\">退出登录</button>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      locationPermission: 'unknown'\n    }\n  },\n  onShow() {\n    this.checkPermissionStatus()\n  },\n  methods: {\n    async checkPermissionStatus() {\n      try {\n        const res = await uni.getSetting()\n        const status = res.authSetting['scope.userLocation']\n        this.locationPermission = status ? 'authorized' : 'denied'\n      } catch (e) {\n        console.error('获取权限状态失败:', e)\n        this.locationPermission = 'unknown'\n      }\n    },\n\n    async handleSwitchChange(e) {\n      const isOn = e.detail.value\n      if (isOn) {\n        try {\n          await uni.authorize({ scope: 'scope.userLocation' })\n          this.locationPermission = 'authorized'\n          uni.showToast({ title: '定位权限已开启', icon: 'success' })\n        } catch (error) {\n          uni.showModal({\n            title: '位置权限申请',\n            content: '需要位置权限来提供应急导航服务，请前往设置开启',\n            confirmText: '立即开启',\n            success: async (res) => {\n              if (res.confirm) {\n                const { authSetting } = await uni.openSetting()\n                if (authSetting['scope.userLocation']) {\n                  this.locationPermission = 'authorized'\n                  uni.showToast({ title: '权限已开启', icon: 'success' })\n                } else {\n                  this.locationPermission = 'denied'\n                }\n              }\n            }\n          })\n        }\n      } else {\n        uni.showModal({\n          title: '关闭定位权限',\n          content: '需要到系统设置中关闭定位权限，是否立即前往？',\n          confirmText: '前往设置',\n          success: async (res) => {\n            if (res.confirm) {\n              await uni.openSetting()\n              this.checkPermissionStatus()\n            }\n          }\n        })\n      }\n    },\n\n    navigateTo(url) {\n      uni.navigateTo({ url })\n    },\n\n    goBack() {\n      uni.navigateBack()\n    },\n\n    logout() {\n      uni.showModal({\n        title: '确认退出',\n        content: '确定要退出当前账号吗？',\n        success: (res) => {\n          if (res.confirm) {\n            uni.reLaunch({ url: '/pages/login/login' })\n          }\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.settings-container {\n  min-height: 100vh;\n  background-color: #f5f5f5;\n  padding-bottom: 100rpx;\n  \n  .settings-list {\n    background-color: #fff;\n    margin-top: 20rpx;\n    \n    .section-title {\n      padding: 20rpx 30rpx;\n      font-size: 26rpx;\n      color: #999;\n      border-bottom: 1rpx solid #f5f5f5;\n    }\n    \n    .setting-item {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 30rpx;\n      border-bottom: 1rpx solid #f5f5f5;\n      \n      .item-left {\n        display: flex;\n        align-items: center;\n        \n        text {\n          margin-left: 20rpx;\n          font-size: 30rpx;\n          color: #333;\n        }\n      }\n      \n      .item-right {\n        display: flex;\n        align-items: center;\n        \n        .permission-switch {\n          transform: scale(0.85);\n          transform-origin: right center;\n        }\n      }\n      \n      &:active {\n        background-color: #f9f9f9;\n      }\n    }\n  }\n  \n  .logout-btn {\n    margin-top: 60rpx;\n    padding: 0 30rpx;\n    \n    button {\n      background-color: #fff;\n      color: #2867CE;\n      border: none;\n      height: 90rpx;\n      line-height: 90rpx;\n      font-size: 32rpx;\n      border-radius: 10rpx;\n      \n      &:active {\n        opacity: 0.8;\n      }\n    }\n  }\n}\n</style>","import MiniProgramPage from 'C:/Users/SZQ/Desktop/jinleyou_GitHub/jinleyou_uniapp/pages/my/setting.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AA8CA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,oBAAoB;AAAA,IACtB;AAAA,EACD;AAAA,EACD,SAAS;AACP,SAAK,sBAAsB;AAAA,EAC5B;AAAA,EACD,SAAS;AAAA,IACP,MAAM,wBAAwB;AAC5B,UAAI;AACF,cAAM,MAAM,MAAMA,cAAG,MAAC,WAAW;AACjC,cAAM,SAAS,IAAI,YAAY,oBAAoB;AACnD,aAAK,qBAAqB,SAAS,eAAe;AAAA,MACpD,SAAS,GAAG;AACVA,sBAAAA,MAAc,MAAA,SAAA,8BAAA,aAAa,CAAC;AAC5B,aAAK,qBAAqB;AAAA,MAC5B;AAAA,IACD;AAAA,IAED,MAAM,mBAAmB,GAAG;AAC1B,YAAM,OAAO,EAAE,OAAO;AACtB,UAAI,MAAM;AACR,YAAI;AACF,gBAAMA,cAAG,MAAC,UAAU,EAAE,OAAO,qBAAmB,CAAG;AACnD,eAAK,qBAAqB;AAC1BA,wBAAG,MAAC,UAAU,EAAE,OAAO,WAAW,MAAM,WAAW;AAAA,QACnD,SAAO,OAAO;AACdA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,SAAS;AAAA,YACT,aAAa;AAAA,YACb,SAAS,OAAO,QAAQ;AACtB,kBAAI,IAAI,SAAS;AACf,sBAAM,EAAE,YAAU,IAAM,MAAMA,cAAAA,MAAI,YAAY;AAC9C,oBAAI,YAAY,oBAAoB,GAAG;AACrC,uBAAK,qBAAqB;AAC1BA,gCAAG,MAAC,UAAU,EAAE,OAAO,SAAS,MAAM,WAAW;AAAA,uBAC5C;AACL,uBAAK,qBAAqB;AAAA,gBAC5B;AAAA,cACF;AAAA,YACF;AAAA,WACD;AAAA,QACH;AAAA,aACK;AACLA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,SAAS;AAAA,UACT,aAAa;AAAA,UACb,SAAS,OAAO,QAAQ;AACtB,gBAAI,IAAI,SAAS;AACf,oBAAMA,cAAAA,MAAI,YAAY;AACtB,mBAAK,sBAAsB;AAAA,YAC7B;AAAA,UACF;AAAA,SACD;AAAA,MACH;AAAA,IACD;AAAA,IAED,WAAW,KAAK;AACdA,0BAAI,WAAW,EAAE,KAAK;AAAA,IACvB;AAAA,IAED,SAAS;AACPA,oBAAAA,MAAI,aAAa;AAAA,IAClB;AAAA,IAED,SAAS;AACPA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,SAAS;AACfA,0BAAAA,MAAI,SAAS,EAAE,KAAK,sBAAsB;AAAA,UAC5C;AAAA,QACF;AAAA,OACD;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9HA,GAAG,WAAW,eAAe;"}