{"version":3,"file":"change_password.js","sources":["pages/my/change_password.vue","../../Programming/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbXkvY2hhbmdlX3Bhc3N3b3JkLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"auth-container\">\n\t\t<!-- 顶部logo -->\n\t\t<view class=\"auth-header\">\n\t\t\t<image class=\"logo\" src=\"/static/logo.png\" mode=\"aspectFit\" />\n\t\t\t<text class=\"title\">修改密码</text>\n\t\t</view>\n\n\t\t<!-- 修改密码表单 -->\n\t\t<view class=\"auth-form\">\n\t\t\t<!-- 用户名/手机号 -->\n\t\t\t<view class=\"form-item\" :class=\"{ error: errors.usernameOrPhone }\">\n\t\t\t\t<uni-icons type=\"person\" size=\"20\" color=\"#2867CE\" />\n\t\t\t\t<input \n\t\t\t\t\tv-model=\"form.usernameOrPhone\"\n\t\t\t\t\tplaceholder=\"请输入用户名或手机号\"\n\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\tmaxlength=\"20\"\n\t\t\t\t\t@focus=\"resetError('usernameOrPhone')\"\n\t\t\t\t>\n\t\t\t</view>\n\t\t\t<text v-if=\"errors.usernameOrPhone\" class=\"error-tip\">{{ errors.usernameOrPhone }}</text>\n\n\t\t\t<!-- 原密码 -->\n\t\t\t<view class=\"form-item\" :class=\"{ error: errors.oldPassword }\">\n\t\t\t\t<uni-icons type=\"locked\" size=\"20\" color=\"#2867CE\" />\n\t\t\t\t<input\n\t\t\t\t\tv-model=\"form.oldPassword\"\n\t\t\t\t\tplaceholder=\"请输入原密码\"\n\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\t:password=\"!showOldPassword\"\n\t\t\t\t\tmaxlength=\"20\"\n\t\t\t\t\t@focus=\"resetError('oldPassword')\"\n\t\t\t\t/>\n\t\t\t\t<view class=\"eye-icon\" @click=\"showOldPassword = !showOldPassword\">\n\t\t\t\t\t<uni-icons :type=\"showOldPassword ? 'eye' : 'eye-slash'\" size=\"20\" color=\"#2867CE\" />\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<text v-if=\"errors.oldPassword\" class=\"error-tip\">{{ errors.oldPassword }}</text>\n\n\t\t\t<!-- 新密码 -->\n\t\t\t<view class=\"form-item\" :class=\"{ error: errors.newPassword }\">\n\t\t\t\t<uni-icons type=\"locked\" size=\"20\" color=\"#2867CE\" />\n\t\t\t\t<input\n\t\t\t\t\tv-model=\"form.newPassword\"\n\t\t\t\t\tplaceholder=\"请输入新密码（至少6位数字）\"\n\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\t:password=\"!showNewPassword\"\n\t\t\t\t\tmaxlength=\"20\"\n\t\t\t\t\t@focus=\"resetError('newPassword')\"\n\t\t\t\t/>\n\t\t\t\t<view class=\"eye-icon\" @click=\"showNewPassword = !showNewPassword\">\n\t\t\t\t\t<uni-icons :type=\"showNewPassword ? 'eye' : 'eye-slash'\" size=\"20\" color=\"#2867CE\" />\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<text v-if=\"errors.newPassword\" class=\"error-tip\">{{ errors.newPassword }}</text>\n\n\t\t\t<!-- 确认新密码 -->\n\t\t\t<view class=\"form-item\" :class=\"{ error: errors.confirmNewPassword }\">\n\t\t\t\t<uni-icons type=\"locked\" size=\"20\" color=\"#2867CE\" />\n\t\t\t\t<input\n\t\t\t\t\tv-model=\"form.confirmNewPassword\"\n\t\t\t\t\tplaceholder=\"请确认新密码\"\n\t\t\t\t\tplaceholder-class=\"placeholder\"\n\t\t\t\t\t:password=\"!showNewPassword\"\n\t\t\t\t\tmaxlength=\"20\"\n\t\t\t\t\t@focus=\"resetError('confirmNewPassword')\"\n\t\t\t\t/>\n\t\t\t\t<view class=\"eye-icon\" @click=\"showNewPassword = !showNewPassword\">\n\t\t\t\t\t<uni-icons :type=\"showNewPassword ? 'eye' : 'eye-slash'\" size=\"20\" color=\"#2867CE\" />\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<text v-if=\"errors.confirmNewPassword\" class=\"error-tip\">{{ errors.confirmNewPassword }}</text>\n\n\t\t\t<!-- 提交按钮 -->\n\t\t\t<button \n\t\t\t\tclass=\"auth-btn primary\"\n\t\t\t\t:class=\"{ disabled: !formValid }\"\n\t\t\t\t:disabled=\"!formValid || loading\"\n\t\t\t\t@click=\"handleChangePassword\"\n\t\t\t>\n\t\t\t\t<text v-if=\"!loading\">提交修改</text>\n\t\t\t\t<uni-load-more v-else status=\"loading\" :icon-size=\"16\" />\n\t\t\t</button>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nimport { http } from '@/api/http'\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tform: {\n\t\t\t\tusernameOrPhone: '',\n\t\t\t\toldPassword: '',\n\t\t\t\tnewPassword: '',\n\t\t\t\tconfirmNewPassword: ''\n\t\t\t},\n\t\t\terrors: {\n\t\t\t\tusernameOrPhone: '',\n\t\t\t\toldPassword: '',\n\t\t\t\tnewPassword: '',\n\t\t\t\tconfirmNewPassword: ''\n\t\t\t},\n\t\t\tshowOldPassword: false,\n\t\t\tshowNewPassword: false,\n\t\t\tloading: false\n\t\t}\n\t},\n\tcomputed: {\n\t\tformValid() {\n\t\t\treturn (\n\t\t\t\tthis.form.usernameOrPhone && \n\t\t\t\tthis.form.oldPassword && \n\t\t\t\tthis.form.newPassword && \n\t\t\t\tthis.form.confirmNewPassword &&  \n\t\t\t\t!Object.values(this.errors).some(err => err)\n\t\t\t)\n\t\t}\n\t},\n\tmethods: {\n\t\tvalidate() {\n\t\t\tlet valid = true\n\t\t\t// 用户名/手机号验证\n\t\t\tif (!this.form.usernameOrPhone.trim()) {\n\t\t\t\tthis.errors.usernameOrPhone = '请输入用户名或手机号'\n\t\t\t\tvalid = false\n\t\t\t} else if (\n\t\t\t\t!/^(1[3-9]\\d{9}|[\\w\\u4e00-\\u9fa5]{4,20})$/.test(this.form.usernameOrPhone)\n\t\t\t) {\n\t\t\t\tthis.errors.usernameOrPhone = '格式不正确'\n\t\t\t\tvalid = false\n\t\t\t}\n\n\t\t\t// 原密码验证\n\t\t\tif (!this.form.oldPassword) {\n\t\t\t\tthis.errors.oldPassword = '请输入原密码'\n\t\t\t\tvalid = false\n\t\t\t}\n\n\t\t\t// 新密码验证\n\t\t\tif (!this.form.newPassword) {\n\t\t\t\tthis.errors.newPassword = '请输入新密码'\n\t\t\t\tvalid = false\n\t\t\t} else if (this.form.newPassword.length < 6) {\n\t\t\t\tthis.errors.newPassword = '密码长度至少6位'\n\t\t\t\tvalid = false\n\t\t\t}\n\n\t\t\t// 确认密码验证\n\t\t\tif (!this.form.confirmNewPassword) {\n\t\t\t\tthis.errors.confirmNewPassword = '请确认密码'\n\t\t\t\tvalid = false\n\t\t\t} else if (this.form.confirmNewPassword !== this.form.newPassword) {\n\t\t\t\tthis.errors.confirmNewPassword = '两次输入的密码不一致'\n\t\t\t\tvalid = false\n\t\t\t}\n\n\t\t\treturn valid\n\t\t},\n\t\tresetError(field) {\n\t\t\tthis.errors[field] = ''\n\t\t},\n\t\tasync handleChangePassword() {\n\t\t\tif (!this.validate()) return\n\t\t\t\n\t\t\tthis.loading = true\n\t\t\ttry {\n\t\t\t\tconst res = await http.post('/api/auth/change-password', {\n\t\t\t\t\tidentifier: this.form.usernameOrPhone,\n\t\t\t\t\toldPassword: this.form.oldPassword,\n\t\t\t\t\tnewPassword: this.form.newPassword\n\t\t\t\t})\n\n\t\t\t\tif (res?.code === 200) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '修改成功',\n\t\t\t\t\t\ticon: 'success',\n\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\tuni.navigateBack()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({ \n\t\t\t\t\t\ttitle: res?.data?.message || '修改失败', \n\t\t\t\t\t\ticon: 'none' \n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('修改失败:', error)\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '网络错误，请稍后重试',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t} finally {\n\t\t\t\tthis.loading = false\n\t\t\t}\n\t\t}\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.auth-container {\n\tpadding: 60rpx 50rpx;\n\tmin-height: 100vh;\n\tdisplay: flex;\n\tflex-direction: column;\n  \n\t.auth-header {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tmargin-bottom: 80rpx;\n    \n\t\t.logo {\n\t\t\twidth: 150rpx;\n\t\t\theight: 150rpx;\n\t\t\tborder-radius: 30rpx;\n\t\t}\n    \n\t\t.title {\n\t\t\tfont-size: 40rpx;\n\t\t\tfont-weight: bold;\n\t\t\tmargin-top: 20rpx;\n\t\t\tcolor: #333;\n\t\t}\n\t}\n  \n\t.auth-form {\n\t\t.form-item {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tpadding: 25rpx 0;\n\t\t\tborder-bottom: 1rpx solid #e5e5e5;\n\t\t\tmargin-bottom: 10rpx;\n\t\t\tposition: relative;\n      \n\t\t\t&.error {\n\t\t\t\tborder-bottom-color: #ff5a5f;\n\t\t\t}\n      \n\t\t\tinput {\n\t\t\t\tflex: 1;\n\t\t\t\tmargin-left: 20rpx;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\theight: 50rpx;\n\t\t\t\tline-height: 50rpx;\n\t\t\t}\n      \n\t\t\t.placeholder {\n\t\t\t\tcolor: #ccc;\n\t\t\t\tfont-size: 28rpx;\n\t\t\t}\n      \n\t\t\t.eye-icon {\n\t\t\t\tpadding: 10rpx;\n\t\t\t}\n\t\t}\n    \n\t\t.error-tip {\n\t\t\tcolor: #ff5a5f;\n\t\t\tfont-size: 24rpx;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\tdisplay: block;\n\t\t\theight: 40rpx;\n\t\t}\n    \n\t\t.auth-btn {\n\t\t\tmargin-top: 60rpx;\n\t\t\theight: 90rpx;\n\t\t\tline-height: 90rpx;\n\t\t\tfont-size: 32rpx;\n\t\t\tborder-radius: 45rpx;\n\t\t\ttransition: all 0.3s;\n\t\t  \n\t\t\t&.primary {\n\t\t\t\tbackground-color: #2867CE;\n\t\t\t\tcolor: #fff;\n\t\t\t}\n\t\t  \n\t\t\t&.disabled {\n\t\t\t\tbackground-color: #ccc;\n\t\t\t\topacity: 0.7;\n\t\t\t}\n\t\t}\n    \n\t\t.auth-footer {\n\t\t\ttext-align: center;\n\t\t\tmargin-top: 30rpx;\n\t\t\tfont-size: 26rpx;\n\t\t\tcolor: #666;\n\t\t\t  \n\t\t\t.link {\n\t\t\t\tcolor: #2867CE;\n\t\t\t\tmargin-left: 10rpx;\n\t\t\t}\n\t\t}\r\n\t\t\r\n\t\t.captcha-problem {\r\n\t\t\tmargin: 0 10rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t}\r\n\t\t.refresh-icon {\r\n\t\t\tpadding: 10rpx;\r\n\t\t\tmargin-left: 10rpx;\r\n\t\t}\n\t}\n}\n</style>","import MiniProgramPage from 'C:/Users/SZQ/Desktop/jinleyou_GitHub/jinleyou_uniapp/pages/my/change_password.vue'\nwx.createPage(MiniProgramPage)"],"names":["http","uni"],"mappings":";;;;AA0FA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,MAAM;AAAA,QACL,iBAAiB;AAAA,QACjB,aAAa;AAAA,QACb,aAAa;AAAA,QACb,oBAAoB;AAAA,MACpB;AAAA,MACD,QAAQ;AAAA,QACP,iBAAiB;AAAA,QACjB,aAAa;AAAA,QACb,aAAa;AAAA,QACb,oBAAoB;AAAA,MACpB;AAAA,MACD,iBAAiB;AAAA,MACjB,iBAAiB;AAAA,MACjB,SAAS;AAAA,IACV;AAAA,EACA;AAAA,EACD,UAAU;AAAA,IACT,YAAY;AACX,aACC,KAAK,KAAK,mBACV,KAAK,KAAK,eACV,KAAK,KAAK,eACV,KAAK,KAAK,sBACV,CAAC,OAAO,OAAO,KAAK,MAAM,EAAE,KAAK,SAAO,GAAG;AAAA,IAE7C;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,WAAW;AACV,UAAI,QAAQ;AAEZ,UAAI,CAAC,KAAK,KAAK,gBAAgB,KAAI,GAAI;AACtC,aAAK,OAAO,kBAAkB;AAC9B,gBAAQ;AAAA,MACT,WACC,CAAC,0CAA0C,KAAK,KAAK,KAAK,eAAe,GACxE;AACD,aAAK,OAAO,kBAAkB;AAC9B,gBAAQ;AAAA,MACT;AAGA,UAAI,CAAC,KAAK,KAAK,aAAa;AAC3B,aAAK,OAAO,cAAc;AAC1B,gBAAQ;AAAA,MACT;AAGA,UAAI,CAAC,KAAK,KAAK,aAAa;AAC3B,aAAK,OAAO,cAAc;AAC1B,gBAAQ;AAAA,MACT,WAAW,KAAK,KAAK,YAAY,SAAS,GAAG;AAC5C,aAAK,OAAO,cAAc;AAC1B,gBAAQ;AAAA,MACT;AAGA,UAAI,CAAC,KAAK,KAAK,oBAAoB;AAClC,aAAK,OAAO,qBAAqB;AACjC,gBAAQ;AAAA,iBACE,KAAK,KAAK,uBAAuB,KAAK,KAAK,aAAa;AAClE,aAAK,OAAO,qBAAqB;AACjC,gBAAQ;AAAA,MACT;AAEA,aAAO;AAAA,IACP;AAAA,IACD,WAAW,OAAO;AACjB,WAAK,OAAO,KAAK,IAAI;AAAA,IACrB;AAAA,IACD,MAAM,uBAAuB;;AAC5B,UAAI,CAAC,KAAK,SAAQ;AAAI;AAEtB,WAAK,UAAU;AACf,UAAI;AACH,cAAM,MAAM,MAAMA,cAAK,KAAK,6BAA6B;AAAA,UACxD,YAAY,KAAK,KAAK;AAAA,UACtB,aAAa,KAAK,KAAK;AAAA,UACvB,aAAa,KAAK,KAAK;AAAA,SACvB;AAED,aAAI,2BAAK,UAAS,KAAK;AACtBC,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,YACN,UAAU,MAAM;AACfA,4BAAAA,MAAI,aAAa;AAAA,YAClB;AAAA,WACA;AAAA,eACK;AACNA,wBAAAA,MAAI,UAAU;AAAA,YACb,SAAO,gCAAK,SAAL,mBAAW,YAAW;AAAA,YAC7B,MAAM;AAAA,WACN;AAAA,QACF;AAAA,MACC,SAAO,OAAO;AACfA,sBAAAA,4DAAc,SAAS,KAAK;AAC5BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,SACN;AAAA,MACF,UAAU;AACT,aAAK,UAAU;AAAA,MAChB;AAAA,IACD;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvMA,GAAG,WAAW,eAAe;"}