{"version":3,"file":"index.js","sources":["pages/forgot-password/index.vue","../Programming/HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZm9yZ290LXBhc3N3b3JkL2luZGV4LnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"auth-container\">\n    <!-- 顶部logo -->\n    <view class=\"auth-header\">\n      <image class=\"logo\" src=\"/static/logo.png\" mode=\"aspectFit\" />\n      <text class=\"title\">找回密码</text>\n    </view>\n\n    <!-- 找回密码表单 -->\n    <view class=\"auth-form\">\n      <view class=\"form-item\" :class=\"{ error: errors.phone }\">\n        <uni-icons type=\"phone\" size=\"20\" color=\"#999\" />\n        <input \n          v-model=\"form.phone\"\n          placeholder=\"请输入手机号\"\n          placeholder-class=\"placeholder\"\n          maxlength=\"11\"\n          @focus=\"resetError('phone')\"\n        />\n      </view>\n      <text v-if=\"errors.phone\" class=\"error-tip\">{{ errors.phone }}</text>\n\n      <view class=\"form-item\" :class=\"{ error: errors.code }\">\n        <uni-icons type=\"shield\" size=\"20\" color=\"#999\" />\n        <input \n          v-model=\"form.code\"\n          placeholder=\"请输入验证码\"\n          placeholder-class=\"placeholder\"\n          maxlength=\"6\"\n          @focus=\"resetError('code')\"\n        />\n        <button \n          class=\"sms-btn\" \n          :disabled=\"countdown > 0 || !canGetCode\"\n          @click=\"sendSmsCode\"\n        >\n          {{ countdown > 0 ? `${countdown}s后重试` : '获取验证码' }}\n        </button>\n      </view>\n      <text v-if=\"errors.code\" class=\"error-tip\">{{ errors.code }}</text>\n\n      <view class=\"form-item\" :class=\"{ error: errors.password }\">\n        <uni-icons type=\"locked\" size=\"20\" color=\"#999\" />\n        <input\n          v-model=\"form.password\"\n          placeholder=\"请输入新密码\"\n          placeholder-class=\"placeholder\"\n          password\n          maxlength=\"20\"\n          @focus=\"resetError('password')\"\n        />\n        <view class=\"eye-icon\" @click=\"showPassword = !showPassword\">\n          <uni-icons :type=\"showPassword ? 'eye' : 'eye-slash'\" size=\"20\" color=\"#999\" />\n        </view>\n      </view>\n      <text v-if=\"errors.password\" class=\"error-tip\">{{ errors.password }}</text>\n\n      <view class=\"form-item\" :class=\"{ error: errors.confirmPassword }\">\n        <uni-icons type=\"locked\" size=\"20\" color=\"#999\" />\n        <input\n          v-model=\"form.confirmPassword\"\n          placeholder=\"请确认新密码\"\n          placeholder-class=\"placeholder\"\n          password\n          maxlength=\"20\"\n          @focus=\"resetError('confirmPassword')\"\n        />\n      </view>\n      <text v-if=\"errors.confirmPassword\" class=\"error-tip\">{{ errors.confirmPassword }}</text>\n\n      <button \n        class=\"auth-btn primary\"\n        :class=\"{ disabled: !formValid }\"\n        :disabled=\"!formValid || loading\"\n        @click=\"handleResetPassword\"\n      >\n        <text v-if=\"!loading\">重置密码</text>\n        <uni-load-more v-else status=\"loading\" :icon-size=\"16\" />\n      </button>\n\n      <view class=\"auth-footer\">\n        <text>记起密码了？</text>\n        <text class=\"link\" @click=\"navigateTo('/pages/login/login')\">立即登录</text>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      form: {\n        phone: '',\n        code: '',\n        password: '',\n        confirmPassword: ''\n      },\n      errors: {\n        phone: '',\n        code: '',\n        password: '',\n        confirmPassword: ''\n      },\n      showPassword: false,\n      countdown: 0,\n      loading: false,\n      timer: null\n    }\n  },\n  computed: {\n    canGetCode() {\n      return /^1[3-9]\\d{9}$/.test(this.form.phone)\n    },\n    formValid() {\n      return (\n        this.form.phone && \n        this.form.code && \n        this.form.password && \n        this.form.confirmPassword && \n        !this.errors.phone && \n        !this.errors.code && \n        !this.errors.password && \n        !this.errors.confirmPassword\n      )\n    }\n  },\n  methods: {\n    validate() {\n      let valid = true\n      \n      if (!this.form.phone) {\n        this.errors.phone = '请输入手机号'\n        valid = false\n      } else if (!/^1[3-9]\\d{9}$/.test(this.form.phone)) {\n        this.errors.phone = '手机号格式不正确'\n        valid = false\n      }\n      \n      if (!this.form.code) {\n        this.errors.code = '请输入验证码'\n        valid = false\n      } else if (!/^\\d{6}$/.test(this.form.code)) {\n        this.errors.code = '验证码格式不正确'\n        valid = false\n      }\n      \n      if (!this.form.password) {\n        this.errors.password = '请输入新密码'\n        valid = false\n      } else if (this.form.password.length < 6) {\n        this.errors.password = '密码长度至少6位'\n        valid = false\n      }\n      \n      if (!this.form.confirmPassword) {\n        this.errors.confirmPassword = '请确认新密码'\n        valid = false\n      } else if (this.form.confirmPassword !== this.form.password) {\n        this.errors.confirmPassword = '两次输入的密码不一致'\n        valid = false\n      }\n      \n      return valid\n    },\n    \n    resetError(field) {\n      this.errors[field] = ''\n    },\n    \n    async sendSmsCode() {\n      if (!this.canGetCode) return\n      \n      try {\n        const res = await uni.request({\n          url: '/api/auth/send-sms',\n          method: 'POST',\n          data: {\n            phone: this.form.phone,\n            type: 'reset-password'\n          }\n        })\n        \n        if (res.data.code === 200) {\n          uni.showToast({\n            title: '验证码已发送',\n            icon: 'success'\n          })\n          this.startCountdown()\n        } else {\n          uni.showToast({\n            title: res.data.message || '发送失败',\n            icon: 'none'\n          })\n        }\n      } catch (error) {\n        console.error('发送验证码失败:', error)\n        uni.showToast({\n          title: '发送失败，请稍后重试',\n          icon: 'none'\n        })\n      }\n    },\n    \n    startCountdown() {\n      this.countdown = 60\n      this.timer = setInterval(() => {\n        if (this.countdown <= 0) {\n          clearInterval(this.timer)\n          return\n        }\n        this.countdown--\n      }, 1000)\n    },\n    \n    async handleResetPassword() {\n      if (!this.validate()) return\n      \n      this.loading = true\n      try {\n        const res = await uni.request({\n          url: '/api/auth/reset-password',\n          method: 'POST',\n          data: {\n            phone: this.form.phone,\n            code: this.form.code,\n            password: this.form.password\n          }\n        })\n        \n        if (res.data.code === 200) {\n          uni.showToast({\n            title: '密码重置成功',\n            icon: 'success',\n            complete: () => {\n              uni.navigateTo({ url: '/pages/login/login' })\n            }\n          })\n        } else {\n          uni.showToast({\n            title: res.data.message || '重置失败',\n            icon: 'none'\n          })\n        }\n      } catch (error) {\n        console.error('重置密码失败:', error)\n        uni.showToast({\n          title: '网络错误，请稍后重试',\n          icon: 'none'\n        })\n      } finally {\n        this.loading = false\n      }\n    },\n    \n    navigateTo(url) {\n      uni.navigateTo({ url })\n    }\n  },\n  beforeUnmount() {\n    if (this.timer) clearInterval(this.timer)\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.auth-container {\n  padding: 60rpx 50rpx;\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  \n  .auth-header {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    margin-bottom: 80rpx;\n    \n    .logo {\n      width: 150rpx;\n      height: 150rpx;\n      border-radius: 30rpx;\n    }\n    \n    .title {\n      font-size: 40rpx;\n      font-weight: bold;\n      margin-top: 20rpx;\n      color: #333;\n    }\n  }\n  \n  .auth-form {\n    .form-item {\n      display: flex;\n      align-items: center;\n      padding: 25rpx 0;\n      border-bottom: 1rpx solid #e5e5e5;\n      margin-bottom: 10rpx;\n      position: relative;\n      \n      &.error {\n        border-bottom-color: #ff5a5f;\n      }\n      \n      input {\n        flex: 1;\n        margin-left: 20rpx;\n        font-size: 28rpx;\n        height: 50rpx;\n        line-height: 50rpx;\n      }\n      \n      .placeholder {\n        color: #ccc;\n        font-size: 28rpx;\n      }\n      \n      .eye-icon {\n        padding: 10rpx;\n      }\n      \n      .sms-btn {\n        font-size: 24rpx;\n        color: #4cd964;\n        background: none;\n        border: none;\n        padding: 0;\n        margin: 0;\n        white-space: nowrap;\n        \n        &[disabled] {\n          color: #999;\n        }\n      }\n    }\n    \n    .error-tip {\n      color: #ff5a5f;\n      font-size: 24rpx;\n      margin-bottom: 20rpx;\n      display: block;\n      height: 40rpx;\n    }\n    \n    .auth-btn {\n      margin-top: 60rpx;\n      height: 90rpx;\n      line-height: 90rpx;\n      font-size: 32rpx;\n      border-radius: 45rpx;\n      transition: all 0.3s;\n      \n      &.primary {\n        background-color: #4cd964;\n        color: #fff;\n      }\n      \n      &.disabled {\n        background-color: #ccc;\n        opacity: 0.7;\n      }\n    }\n    \n    .auth-footer {\n      text-align: center;\n      margin-top: 30rpx;\n      font-size: 26rpx;\n      color: #666;\n      \n      .link {\n        color: #4cd964;\n        margin-left: 10rpx;\n      }\n    }\n  }\n}\n</style>","import MiniProgramPage from 'C:/Users/SZQ/Desktop/jinleyou_uniapp/pages/forgot-password/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}